<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Machine Learning Path</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="min-h-screen bg-slate-50 text-slate-800 font-sans pb-20 selection:bg-blue-200">
  <div id="app"></div>

  <script>
    const curriculumData = [
      {
        phase: "Phase 0: Prerequisites",
        phaseAr: "المرحلة 0: المتطلبات الأساسية",
        steps: [
          {
            id: "ph0_s1", name: "Python for Everybody", nameAr: "بايثون للجميع", type: "Specialization", institute: "University of Michigan",
            link: "https://www.coursera.org/specializations/python",
            courses: [
              { id: "ph0_s1_c1", name: "Programming for Everybody (Getting Started with Python)", nameAr: "برمجة للجميع (البدء مع بايثون)", hours: 15 },
              { id: "ph0_s1_c2", name: "Python Data Structures", nameAr: "هياكل بيانات بايثون", hours: 15 },
              { id: "ph0_s1_c3", name: "Using Python to Access Web Data", nameAr: "استخدام بايثون للوصول إلى بيانات الويب", hours: 15 },
              { id: "ph0_s1_c4", name: "Using Databases with Python", nameAr: "استخدام قواعد البيانات مع بايثون", hours: 15 },
              { id: "ph0_s1_c5", name: "Capstone: Retrieving, Processing, and Visualizing Data with Python", nameAr: "مشروع التخرج: استرجاع ومعالجة وتصور البيانات", hours: 20 }
            ]
          },
          {
            id: "ph0_s2", name: "Mathematics for Machine Learning", nameAr: "الرياضيات لتعلم الآلة", type: "Specialization", institute: "Imperial College London",
            link: "https://www.coursera.org/specializations/mathematics-machine-learning",
            courses: [
              { id: "ph0_s2_c1", name: "Mathematics for Machine Learning: Linear Algebra", nameAr: "الجبر الخطي", hours: 18 },
              { id: "ph0_s2_c2", name: "Mathematics for Machine Learning: Multivariate Calculus", nameAr: "التفاضل والتكامل متعدد المتغيرات", hours: 18 },
              { id: "ph0_s2_c3", name: "Mathematics for Machine Learning: PCA", nameAr: "تحليل المكونات الرئيسية (PCA)", hours: 15 }
            ]
          },
          {
            id: "ph0_s3", name: "Python for Data Science, AI & Development", nameAr: "بايثون لعلوم البيانات والذكاء الاصطناعي والتطوير", type: "Course", institute: "IBM",
            link: "https://www.coursera.org/learn/python-for-applied-data-science-ai",
            courses: [
               { id: "ph0_s3_c1", name: "Python for Data Science, AI & Development", nameAr: "بايثون لعلوم البيانات والذكاء الاصطناعي والتطوير", hours: 20 }
            ]
          },
          {
            id: "ph0_s4", name: "Machine Learning with Python", nameAr: "تعلم الآلة باستخدام بايثون", type: "Course", institute: "IBM",
            link: "https://www.coursera.org/learn/machine-learning-with-python",
            courses: [
               { id: "ph0_s4_c1", name: "Machine Learning with Python", nameAr: "تعلم الآلة باستخدام بايثون", hours: 22 }
            ]
          }
        ]
      },
      {
        phase: "Phase I: Foundational Cloud Engineering and Infrastructure",
        phaseAr: "المرحلة الأولى: الهندسة السحابية الأساسية والبنية التحتية",
        steps: [
          {
            id: "ph1_s1", name: "Google Cloud Fundamentals: Core Infrastructure", nameAr: "أساسيات جوجل كلاود: البنية التحتية الأساسية", type: "Course", institute: "Google Cloud Training",
            link: "https://www.coursera.org/learn/gcp-fundamentals",
            courses: [
              { id: "ph1_s1_c1", name: "Google Cloud Fundamentals: Core Infrastructure", nameAr: "أساسيات جوجل كلاود: البنية التحتية الأساسية", hours: 12 }
            ]
          },
          {
            id: "ph1_s2", name: "Preparing for Google Cloud Certification: Cloud Engineer", nameAr: "التحضير لشهادة جوجل كلاود: مهندس سحابي", type: "Professional Certificate", institute: "Google Cloud Training",
            link: "https://www.coursera.org/professional-certificates/cloud-engineering-gcp",
            courses: [
              { id: "ph1_s2_c1", name: "Preparing for Your Associate Cloud Engineer Journey", nameAr: "التحضير لرحلة مهندس السحابة المساعد", hours: 10 },
              { id: "ph1_s2_c2", name: "Essential Google Cloud Infrastructure: Foundation", nameAr: "البنية التحتية الأساسية لجوجل كلاود: التأسيس", hours: 14 },
              { id: "ph1_s2_c3", name: "Essential Google Cloud Infrastructure: Core Services", nameAr: "البنية التحتية الأساسية لجوجل كلاود: الخدمات الأساسية", hours: 14 },
              { id: "ph1_s2_c4", name: "Elastic Google Cloud Infrastructure: Scaling and Automation", nameAr: "البنية التحتية المرنة لجوجل كلاود: التوسع والأتمتة", hours: 12 }
            ]
          }
        ]
      },
      {
        phase: "Phase II: Data Engineering and Big Data",
        phaseAr: "المرحلة الثانية: هندسة البيانات والبيانات الضخمة",
        steps: [
            {
                id: "ph2_s1", name: "Data Engineering, Big Data, and Machine Learning on GCP", nameAr: "هندسة البيانات، البيانات الضخمة، وتعلم الآلة على GCP", type: "Specialization", institute: "Google Cloud Training",
                link: "https://www.coursera.org/specializations/gcp-data-machine-learning",
                courses: [
                    { id: "ph2_s1_c1", name: "Google Cloud Big Data and Machine Learning Fundamentals", nameAr: "أساسيات البيانات الضخمة وتعلم الآلة في جوجل كلاود", hours: 15 },
                    { id: "ph2_s1_c2", name: "Modernizing Data Lakes and Data Warehouses with GCP", nameAr: "تحديث بحيرات ومستودعات البيانات باستخدام GCP", hours: 15 },
                    { id: "ph2_s1_c3", name: "Building Batch Data Pipelines on GCP", nameAr: "بناء مسارات بيانات الدفعات على GCP", hours: 14 },
                    { id: "ph2_s1_c4", name: "Building Resilient Streaming Analytics Systems on GCP", nameAr: "بناء أنظمة تحليلات التدفق المرنة على GCP", hours: 14 }
                ]
            }
        ]
      },
      {
        phase: "Phase III: Machine Learning on Google Cloud",
        phaseAr: "المرحلة الثالثة: تعلم الآلة على جوجل كلاود",
        steps: [
            {
                id: "ph3_s1", name: "Machine Learning on Google Cloud", nameAr: "تعلم الآلة على جوجل كلاود", type: "Specialization", institute: "Google Cloud Training",
                link: "https://www.coursera.org/specializations/machine-learning-tensorflow-gcp",
                courses: [
                    { id: "ph3_s1_c1", name: "How Google does Machine Learning", nameAr: "كيف تقوم جوجل بتعلم الآلة", hours: 12 },
                    { id: "ph3_s1_c2", name: "Launching into Machine Learning", nameAr: "الانطلاق في تعلم الآلة", hours: 15 },
                    { id: "ph3_s1_c3", name: "TensorFlow on Google Cloud", nameAr: "تنسرفلو على جوجل كلاود", hours: 15 },
                    { id: "ph3_s1_c4", name: "Feature Engineering", nameAr: "هندسة الميزات (Feature Engineering)", hours: 12 },
                    { id: "ph3_s1_c5", name: "Machine Learning in the Enterprise", nameAr: "تعلم الآلة في المؤسسات", hours: 12 }
                ]
            }
        ]
      },
      {
        phase: "Phase IV: Advanced ML & MLOps",
        phaseAr: "المرحلة الرابعة: تعلم الآلة المتقدم وعمليات تعلم الآلة (MLOps)",
        steps: [
            {
                id: "ph4_s1", name: "Advanced Machine Learning on Google Cloud", nameAr: "تعلم الآلة المتقدم على جوجل كلاود", type: "Specialization", institute: "Google Cloud Training",
                link: "https://www.coursera.org/specializations/advanced-machine-learning-tensorflow-gcp",
                courses: [
                    { id: "ph4_s1_c1", name: "Production Machine Learning Systems", nameAr: "أنظمة تعلم الآلة في الإنتاج", hours: 14 },
                    { id: "ph4_s1_c2", name: "Computer Vision Fundamentals with Google Cloud", nameAr: "أساسيات الرؤية الحاسوبية مع جوجل كلاود", hours: 12 },
                    { id: "ph4_s1_c3", name: "Natural Language Processing on Google Cloud", nameAr: "معالجة اللغات الطبيعية على جوجل كلاود", hours: 14 }
                ]
            },
            {
                id: "ph4_s2", name: "Machine Learning Operations (MLOps): Getting Started", nameAr: "عمليات تعلم الآلة (MLOps): البدء", type: "Course", institute: "Google Cloud Training",
                link: "https://www.coursera.org/learn/mlops-fundamentals",
                courses: [
                    { id: "ph4_s2_c1", name: "Machine Learning Operations (MLOps): Getting Started", nameAr: "عمليات تعلم الآلة (MLOps): البدء", hours: 12 }
                ]
            }
        ]
      },
      {
        phase: "Phase V: Generative AI",
        phaseAr: "المرحلة الخامسة: الذكاء الاصطناعي التوليدي",
        steps: [
          {
            id: "ph5_s1", name: "Introduction to Generative AI Learning Path", nameAr: "مسار تعلم مقدمة إلى الذكاء الاصطناعي التوليدي", type: "Specialization", institute: "Google Cloud Training",
            link: "https://www.coursera.org/specializations/introduction-to-generative-ai",
            courses: [
              { id: "ph5_s1_c1", name: "Introduction to Generative AI", nameAr: "مقدمة في الذكاء الاصطناعي التوليدي", hours: 8 },
              { id: "ph5_s1_c2", name: "Introduction to Large Language Models", nameAr: "مقدمة في النماذج اللغوية الكبيرة (LLMs)", hours: 8 },
              { id: "ph5_s1_c3", name: "Introduction to Responsible AI", nameAr: "مقدمة في الذكاء الاصطناعي المسؤول", hours: 8 },
              { id: "ph5_s1_c4", name: "Responsible AI: Applying AI Principles with Google Cloud", nameAr: "تطبيق مبادئ الذكاء الاصطناعي المسؤول مع جوجل كلاود", hours: 10 }
            ]
          },
          {
            id: "ph5_s2", name: "Build and Modernize Applications With Generative AI", nameAr: "بناء وتحديث التطبيقات باستخدام الذكاء الاصطناعي التوليدي", type: "Specialization", institute: "Google Cloud Training",
            link: "https://www.coursera.org/specializations/build-modernize-applications-with-generative-ai",
            courses: [
              { id: "ph5_s2_c1", name: "Gemini for Application Developers", nameAr: "جيميني لمطوري التطبيقات", hours: 10 },
              { id: "ph5_s2_c2", name: "Gemini for end-to-end SDLC", nameAr: "جيميني لدورة حياة تطوير البرمجيات الشاملة", hours: 10 },
              { id: "ph5_s2_c3", name: "Create Generative AI Apps on Google Cloud", nameAr: "إنشاء تطبيقات الذكاء الاصطناعي التوليدي على جوجل كلاود", hours: 12 },
              { id: "ph5_s2_c4", name: "Website Modernization with Generative AI on Google Cloud", nameAr: "تحديث مواقع الويب باستخدام الذكاء الاصطناعي التوليدي", hours: 10 },
              { id: "ph5_s2_c5", name: "Build Generative AI Agents with Vertex AI and Flutter", nameAr: "بناء وكلاء الذكاء الاصطناعي التوليدي باستخدام Vertex AI و Flutter", hours: 12 },
              { id: "ph5_s2_c6", name: "Accelerate App Development with Gemini CLI", nameAr: "تسريع تطوير التطبيقات باستخدام Gemini CLI", hours: 8 },
              { id: "ph5_s2_c7", name: "Deploy and Scale AI Models with Cloud Run", nameAr: "نشر وتوسيع نماذج الذكاء الاصطناعي باستخدام Cloud Run", hours: 10 }
            ]
          }
        ]
      },
      {
        phase: "Phase VI: Practice",
        phaseAr: "المرحلة السادسة: الممارسة العملية",
        steps: [
          {
            id: "ph6_s1", name: "Practice & Hands-on Pipelines", nameAr: "الممارسة ومسارات العمل العملية", type: "Practice", institute: "Self-Paced",
            link: "",
            courses: [
              { id: "ph6_s1_c1", name: "Intensive scenario-based practice exams", nameAr: "امتحانات تدريبية مكثفة تعتمد على السيناريوهات", hours: 20 },
              { id: "ph6_s1_c2", name: "Executing an independent, end-to-end MLOps pipeline directly on GCP", nameAr: "تنفيذ مسار MLOps مستقل وشامل مباشرة على GCP", hours: 30 }
            ]
          }
        ]
      },
      {
        phase: "Phase VII: Exam",
        phaseAr: "المرحلة السابعة: الاختبار",
        steps: [
          {
            id: "ph7_s1", name: "Google Cloud Professional Machine Learning Engineer", nameAr: "مهندس تعلم الآلة المحترف من جوجل كلاود", type: "Certification", institute: "Google Cloud",
            link: "https://cloud.google.com/learn/certification/machine-learning-engineer",
            courses: [
              { id: "ph7_s1_c1", name: "Official Certification Exam", nameAr: "امتحان الشهادة الرسمي", hours: 4 }
            ]
          }
        ]
      }
    ];

    const flatCourseList = [];
    curriculumData.forEach(phase => {
      phase.steps.forEach(step => {
        step.courses.forEach(course => {
          flatCourseList.push(course.id);
        });
      });
    });

    // State Initialization
    const savedProgress = localStorage.getItem('gcp-pmle-progress');
    let completedIds = new Set(savedProgress ? JSON.parse(savedProgress) : []);
    let weeklyHours = 10;
    let expandedPhases = new Set(curriculumData.map(p => p.phase));

    function saveState() {
      localStorage.setItem('gcp-pmle-progress', JSON.stringify([...completedIds]));
    }

    // Global Handlers
    window.toggleCourseState = (id, checked) => {
      const idx = flatCourseList.indexOf(id);
      if (checked) {
        for (let i = 0; i <= idx; i++) completedIds.add(flatCourseList[i]);
      } else {
        for (let i = idx; i < flatCourseList.length; i++) completedIds.delete(flatCourseList[i]);
      }
      saveState();
      render();
    };

    window.toggleStepState = (firstCourseId, lastCourseId, isCompleted) => {
      if (!isCompleted) {
        window.toggleCourseState(lastCourseId, true);
      } else {
        window.toggleCourseState(firstCourseId, false);
      }
    };

    window.togglePhaseExpansion = (phaseName) => {
      if (expandedPhases.has(phaseName)) {
        expandedPhases.delete(phaseName);
      } else {
        expandedPhases.add(phaseName);
      }
      render();
    };

    window.updateWeeklyHours = (val) => {
      weeklyHours = Number(val);
      render();
    };

    // Calculate Metrics
    function calculateMetrics() {
      let tHours = 0;
      let cHours = 0;

      curriculumData.forEach(phase => {
        phase.steps.forEach(step => {
          step.courses.forEach(course => {
            tHours += course.hours;
            if (completedIds.has(course.id)) {
              cHours += course.hours;
            }
          });
        });
      });

      const percent = tHours === 0 ? 0 : Math.round((cHours / tHours) * 100);
      const remaining = tHours - cHours;
      const daysLeft = Math.ceil((remaining * 7) / weeklyHours);
      const dailyPace = (weeklyHours / 7).toFixed(1);

      let estDate = new Date();
      estDate.setDate(estDate.getDate() + daysLeft);
      const dateOptions = { month: 'short', day: 'numeric', year: 'numeric' };
      const estDateString = isNaN(estDate.getTime()) ? 'N/A' : estDate.toLocaleDateString('en-US', dateOptions);

      return { totalHours: tHours, completedHours: cHours, percent, remaining, daysLeft, dailyPace, estDateString };
    }

    // Render Logic
    function render() {
      const metrics = calculateMetrics();
      const appContainer = document.getElementById('app');

      let phasesHTML = curriculumData.map((phase, phaseIdx) => {
        const isExpanded = expandedPhases.has(phase.phase);
        const totalPhaseCourses = phase.steps.reduce((acc, step) => acc + step.courses.length, 0);
        const completedPhaseCourses = phase.steps.reduce((acc, step) => acc + step.courses.filter(c => completedIds.has(c.id)).length, 0);
        const isPhaseCompleted = totalPhaseCourses > 0 && totalPhaseCourses === completedPhaseCourses;

        let stepsHTML = '';
        if (isExpanded) {
          stepsHTML = `<div class="p-4 sm:p-6 bg-slate-50/50 border-t border-slate-100 space-y-6">`;
          
          stepsHTML += phase.steps.map((step, stepIdx) => {
            const isStepCompleted = step.courses.every(c => completedIds.has(c.id));
            const isStepPartiallyCompleted = !isStepCompleted && step.courses.some(c => completedIds.has(c.id));
            const firstCourseId = step.courses[0].id;
            const lastCourseId = step.courses[step.courses.length - 1].id;

            let coursesHTML = `<div class="divide-y divide-slate-100">`;
            coursesHTML += step.courses.map(course => {
              const isCourseCompleted = completedIds.has(course.id);
              return `
                <div class="p-3 sm:px-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 transition-colors hover:bg-blue-50/30 ${isCourseCompleted ? 'bg-slate-50/50' : ''}">
                  <div class="flex items-center gap-3 flex-1 min-w-0">
                    <button onClick="window.toggleCourseState('${course.id}', ${!isCourseCompleted})" class="flex-shrink-0 focus:outline-none">
                      ${isCourseCompleted 
                        ? `<i data-lucide="check-circle-2" class="w-5 h-5 text-blue-500 transition-colors"></i>` 
                        : `<i data-lucide="circle" class="w-5 h-5 text-slate-300 hover:text-blue-400 transition-colors"></i>`
                      }
                    </button>
                    <span class="text-sm font-medium truncate ${isCourseCompleted ? 'text-slate-500 line-through' : 'text-slate-700'}">
                      ${course.name}
                    </span>
                    <span class="text-xs text-slate-400 whitespace-nowrap hidden md:inline-block">(${course.hours}h)</span>
                  </div>
                  <div class="flex items-center gap-3 w-full sm:w-auto justify-end sm:justify-end pl-8 sm:pl-0 mt-1 sm:mt-0" dir="rtl">
                    <span class="text-sm font-medium ${isCourseCompleted ? 'text-slate-500 line-through' : 'text-slate-700'}">
                      ${course.nameAr}
                    </span>
                  </div>
                </div>
              `;
            }).join('');
            coursesHTML += `</div>`;

            const linkHTML = step.link ? `
              <a href="${step.link}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1 text-blue-600 hover:underline">
                Link <i data-lucide="external-link" class="w-3 h-3"></i>
              </a>
            ` : '';

            const stepTypeTranslation = step.type === 'Specialization' ? 'تخصص' : step.type === 'Course' ? 'دورة' : step.type === 'Practice' ? 'تدريب' : 'شهادة';

            return `
              <div class="bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden">
                <div class="p-4 border-b border-slate-100 bg-slate-50/50 flex flex-col md:flex-row gap-4 justify-between items-start">
                  <div class="flex gap-3 items-start flex-1">
                    <button onClick="window.toggleStepState('${firstCourseId}', '${lastCourseId}', ${isStepCompleted})" class="mt-1 flex-shrink-0 focus:outline-none">
                      ${isStepCompleted 
                        ? `<i data-lucide="check-circle-2" class="w-5 h-5 text-blue-600 hover:text-blue-700 transition-colors"></i>` 
                        : isStepPartiallyCompleted 
                          ? `<div class="w-5 h-5 rounded-full border-2 border-blue-600 flex items-center justify-center"><div class="w-2 h-2 bg-blue-600 rounded-full"></div></div>`
                          : `<i data-lucide="circle" class="w-5 h-5 text-slate-300 hover:text-blue-400 transition-colors"></i>`
                      }
                    </button>
                    <div>
                      <h3 class="text-base font-bold text-slate-900">${step.name}</h3>
                      <div class="flex flex-wrap items-center gap-x-3 gap-y-1 text-xs text-slate-500 mt-1.5">
                        <span class="flex items-center gap-1 bg-slate-100 px-2 py-0.5 rounded-md text-slate-600">
                          <i data-lucide="book-open" class="w-3 h-3"></i> ${step.type}
                        </span>
                        <span class="flex items-center gap-1">
                          <i data-lucide="building" class="w-3 h-3"></i> ${step.institute}
                        </span>
                        ${linkHTML}
                      </div>
                    </div>
                  </div>
                  <div class="flex-1 w-full text-right" dir="rtl">
                     <h3 class="text-base font-bold text-slate-900">${step.nameAr}</h3>
                     <div class="flex flex-wrap items-center justify-end gap-x-3 gap-y-1 text-xs text-slate-500 mt-1.5">
                        <span class="flex items-center gap-1 bg-slate-100 px-2 py-0.5 rounded-md text-slate-600">
                          ${stepTypeTranslation} <i data-lucide="book-open" class="w-3 h-3"></i> 
                        </span>
                        <span class="flex items-center gap-1">
                          ${step.institute} <i data-lucide="building" class="w-3 h-3"></i> 
                        </span>
                      </div>
                  </div>
                </div>
                ${coursesHTML}
              </div>
            `;
          }).join('');
          
          stepsHTML += `</div>`;
        }

        return `
          <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden transition-all">
            <button onClick="window.togglePhaseExpansion('${phase.phase}')" class="w-full px-6 py-4 flex flex-col md:flex-row justify-between items-center gap-4 transition-colors hover:bg-slate-50 ${isPhaseCompleted ? 'bg-emerald-50/30' : ''}">
              <div class="flex items-center gap-4 w-full md:w-auto">
                ${isPhaseCompleted 
                  ? `<i data-lucide="check-circle-2" class="w-6 h-6 text-emerald-500 flex-shrink-0"></i>` 
                  : `<i data-lucide="circle" class="w-6 h-6 text-slate-300 flex-shrink-0"></i>`
                }
                <div class="text-left flex-1">
                  <h2 class="text-lg font-bold text-slate-800">${phase.phase}</h2>
                  <div class="text-xs text-slate-500 mt-1">${completedPhaseCourses} / ${totalPhaseCourses} courses completed</div>
                </div>
              </div>
              <div class="flex items-center gap-4 w-full md:w-auto justify-between md:justify-end">
                <h2 class="text-lg font-bold text-slate-800 text-right w-full md:w-auto" dir="rtl">${phase.phaseAr}</h2>
                <i data-lucide="${isExpanded ? 'chevron-up' : 'chevron-down'}" class="w-5 h-5 text-slate-400"></i>
              </div>
            </button>
            ${stepsHTML}
          </div>
        `;
      }).join('');

      appContainer.innerHTML = `
        <header class="bg-white border-b border-slate-200 sticky top-0 z-10 shadow-sm px-4 py-4 sm:px-8">
          <div class="max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="flex items-center gap-3">
              <div class="bg-blue-600 p-2 rounded-lg">
                <i data-lucide="graduation-cap" class="w-6 h-6 text-white"></i>
              </div>
              <div>
                <h1 class="text-xl sm:text-2xl font-bold text-slate-900 leading-tight">Machine Learning Path</h1>
                <h2 class="text-sm font-medium text-slate-500" dir="rtl">مُتتبع مسار مهندس تعلم الآلة المحترف</h2>
              </div>
            </div>
            
            <div class="flex-1 w-full max-w-md hidden md:block">
              <div class="flex justify-between text-xs font-semibold mb-1">
                <span class="text-slate-600">Progress: ${metrics.percent}%</span>
                <span class="text-slate-600" dir="rtl">التقدم</span>
              </div>
              <div class="h-2 w-full bg-slate-200 rounded-full overflow-hidden">
                <div class="h-full bg-blue-600 transition-all duration-500 ease-out" style="width: ${metrics.percent}%"></div>
              </div>
            </div>
          </div>
        </header>

        <main class="max-w-6xl mx-auto px-4 sm:px-8 py-8">
          <section class="mb-10">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
              <div class="bg-white rounded-2xl p-5 shadow-sm border border-slate-100 flex flex-col justify-between">
                <div class="flex justify-between items-start mb-2">
                  <i data-lucide="target" class="w-6 h-6 text-blue-500"></i>
                  <span class="text-2xl font-bold text-slate-800">${metrics.percent}%</span>
                </div>
                <div class="flex justify-between items-end mt-4">
                  <span class="text-sm font-semibold text-slate-600">Total Completion</span>
                  <span class="text-sm font-semibold text-slate-500" dir="rtl">الإنجاز الكلي</span>
                </div>
              </div>

              <div class="bg-white rounded-2xl p-5 shadow-sm border border-slate-100 flex flex-col justify-between">
                <div class="flex justify-between items-start mb-2">
                  <i data-lucide="clock" class="w-6 h-6 text-emerald-500"></i>
                  <span class="text-2xl font-bold text-slate-800">${metrics.estDateString}</span>
                </div>
                <div class="flex justify-between items-end mt-4">
                  <span class="text-sm font-semibold text-slate-600">Est. Date of Finish</span>
                  <span class="text-sm font-semibold text-slate-500" dir="rtl">تاريخ الانتهاء المتوقع</span>
                </div>
              </div>

              <div class="bg-white rounded-2xl p-5 shadow-sm border border-slate-100 flex flex-col justify-between">
                <div class="flex justify-between items-start mb-2">
                  <i data-lucide="calendar" class="w-6 h-6 text-purple-500"></i>
                  <span class="text-2xl font-bold text-slate-800">${metrics.daysLeft} <span class="text-sm font-medium text-slate-500">days</span></span>
                </div>
                <div class="flex justify-between items-end mt-4">
                  <span class="text-sm font-semibold text-slate-600">Time to Finish</span>
                  <span class="text-sm font-semibold text-slate-500" dir="rtl">الوقت للانتهاء</span>
                </div>
              </div>

              <div class="bg-white rounded-2xl p-5 shadow-sm border border-slate-100 flex flex-col justify-between bg-gradient-to-br from-blue-50 to-white">
                 <div class="flex justify-between items-start mb-2">
                  <i data-lucide="award" class="w-6 h-6 text-blue-600"></i>
                  <span class="text-xl font-bold text-blue-700">${metrics.dailyPace} <span class="text-sm font-medium text-blue-500">h/day</span></span>
                </div>
                <div>
                  <div class="flex justify-between items-center text-xs text-slate-500 mb-1">
                    <span>Commitment</span>
                    <span dir="rtl">الالتزام</span>
                  </div>
                  <div class="flex items-center gap-2">
                    <input type="range" min="1" max="40" value="${weeklyHours}" oninput="window.updateWeeklyHours(this.value)" class="w-full accent-blue-600" />
                    <span class="text-xs font-bold w-12 text-right">${weeklyHours}h/wk</span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="md:hidden mt-4">
              <div class="h-2 w-full bg-slate-200 rounded-full overflow-hidden">
                <div class="h-full bg-blue-600 transition-all duration-500 ease-out" style="width: ${metrics.percent}%"></div>
              </div>
            </div>
          </section>

          <section class="space-y-6">
            ${phasesHTML}
          </section>
        </main>
      `;

      lucide.createIcons();
    }

    // Initial render
    render();
  </script>
</body>
</html>
